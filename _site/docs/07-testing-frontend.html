<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Refactorización con pruebas II - Fullstack JS</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Refactorización con pruebas II | Fullstack JS</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Refactorización con pruebas II" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="/docs/07-testing-frontend.html" /> <meta property="og:url" content="/docs/07-testing-frontend.html" /> <meta property="og:site_name" content="Fullstack JS" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Refactorización con pruebas II" /> <script type="application/ld+json"> {"url":"/docs/07-testing-frontend.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/logo.svg"}},"@type":"WebPage","headline":"Refactorización con pruebas II","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Inicio</a></li><li class="nav-list-item"><a href="/docs/01-vue-cli-install.html" class="nav-list-link">Creando proyecto con CLI</a></li><li class="nav-list-item"><a href="/docs/02-bdd-with-cypress.html" class="nav-list-link">Historias de usuario y BDD</a></li><li class="nav-list-item"><a href="/docs/03-monorepo-backend.html" class="nav-list-link">Fullstack Javascript</a></li><li class="nav-list-item"><a href="/docs/04-firebase-sdk-backend.html" class="nav-list-link">Autenticación en backend</a></li><li class="nav-list-item"><a href="/docs/05-database-sequelize.html" class="nav-list-link">Base de datos en desarrollo</a></li><li class="nav-list-item"><a href="/docs/06-testing-backend.html" class="nav-list-link">Refactorización con pruebas I</a></li><li class="nav-list-item active"><a href="/docs/07-testing-frontend.html" class="nav-list-link active">Refactorización con pruebas II</a></li><li class="nav-list-item"><a href="/docs/08-development-workflow-husky.html" class="nav-list-link">Automatización en desarrollo</a></li><li class="nav-list-item"><a href="/docs/09-deployment-postgres.html" class="nav-list-link">Deploy automatizado</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Fullstack JS" aria-label="Search Fullstack JS" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="refactorización-utilizando-pruebas-de-software-en-frontend"> <a href="#refactorización-utilizando-pruebas-de-software-en-frontend" class="anchor-heading" aria-labelledby="refactorización-utilizando-pruebas-de-software-en-frontend"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Refactorización utilizando pruebas de software en Frontend </h1> <p>Continuamos caracterizando la aplicación para refactorizar y dejar la aplicación más flexible y mantenible.</p> <p>A diferencia de las pruebas que escribimos para el Backend, nuestra parte Frontend utiliza el framework VueJS y algunos plugins como Vuex y Vuetify. Esto agrega más de dificultad al momento de escribir las pruebas dado que debemos simular en cada una de ellas como si una aplicación Vue real estuviera funcionando incluyendo todas las cosas que configuramos. Para facilitar las cosas Vue ya trae integrada una librería llamada <code class="language-plaintext highlighter-rouge">@vue/test-utils</code> que nos permitirá hacer algunas cosas necesarias para ejecutar las pruebas. Si quieres aprender mucho más en profundidad como funciona y que cosas se pueden hacer puedes revisar <a href="https://github.com/vuejs/vue-test-utils/">este enlace</a></p> <p>Vuetify al ser una de las librerías que más usamos debido a que está incluida en todas las vistas de nuestra aplicación, necesita de una configuración especial para funcionar. El detalle y varios ejemplos de como hacer esto lo puedes revisar en la <a href="https://vuetifyjs.com/en/getting-started/unit-testing/">sección dedicada a pruebas de software de la documentación de Vuetify</a></p> <p>En resumen debemos configurar las pruebas para que se incluya globalmente en cada prueba. Tenemos que hacer dos pasos para esto. El primero es modificar el archivo <code class="language-plaintext highlighter-rouge">frontend/jest.config.js</code> para que quede así:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">preset</span><span class="p">:</span> <span class="dl">'</span><span class="s1">@vue/cli-plugin-unit-jest</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">setupFilesAfterEnv</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">./jest.setup.js</span><span class="dl">'</span>
  <span class="p">]</span>
<span class="p">}</span>

</code></pre></div></div> <p>A continuación hay que crear el archivo <code class="language-plaintext highlighter-rouge">jest.setup.js</code> en la raíz del directorio <code class="language-plaintext highlighter-rouge">frontend</code> con el siguiente contenido</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuetify</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuetify</span><span class="dl">'</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Vuetify</span><span class="p">)</span>
</code></pre></div></div> <p>Aprovecharemos de incluir la opción para analizar la cobertura de las pruebas de software modificando el archivo <code class="language-plaintext highlighter-rouge">package.json</code> en su sección <code class="language-plaintext highlighter-rouge">scripts</code>:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">"</span><span class="s2">test:unit</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">vue-cli-service test:unit --coverage</span><span class="dl">"</span>
</code></pre></div></div> <p>Una vez configurado esto comenzaremos a escribir las pruebas.</p> <h4 id="casos-de-la-funcionalidad-para-definir-pruebas"> <a href="#casos-de-la-funcionalidad-para-definir-pruebas" class="anchor-heading" aria-labelledby="casos-de-la-funcionalidad-para-definir-pruebas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Casos de la funcionalidad para definir pruebas </h4> <p>En estos momentos el Frontend cuanta con las siguientes características</p> <ul> <li>Una vista <code class="language-plaintext highlighter-rouge">Login</code> con un formulario con Vuetify que como finalidad ejecutar una función <code class="language-plaintext highlighter-rouge">login</code> que a su vez llama al método de autenticación de Firebase. En caso de ser exitoso, se redirige a la página de productos.</li> </ul> <p>El resúmen de ese código lo vemos en la siguiente imagen. <strong>frontend/views/Login.vue</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>

<span class="k">async</span> <span class="nx">login</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Caso 1: Para un formulario válido ir a la página de productos si la autenticación fue exitosa</span>
    <span class="k">await</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
  <span class="p">}</span>
  <span class="c1">// Caso 2: Para un formulario inválido NO llamamos al método de autenticación</span>
<span class="p">}</span>
</code></pre></div></div> <ul> <li>También tenemos una vista llamada <code class="language-plaintext highlighter-rouge">Products</code> que al montarse en el DOM, invoca una acción de Vuex que desencadena que se guarde en el estado una variable llamada <code class="language-plaintext highlighter-rouge">products</code> con la lista de productos provenientes del servidor. Cuando este valor del estado se actualiza, nuestra vista reacciona a esto mostrando la lista de elementos.</li> </ul> <p>Lo vemos en el siguiente resumen <strong>frontend/src/views/Products.vue</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="nx">computed</span><span class="p">:</span> <span class="p">{</span>
<span class="p">...</span><span class="nx">mapState</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">products</span><span class="dl">'</span>
  <span class="p">])</span>
<span class="p">},</span>
<span class="nx">methods</span><span class="p">:</span> <span class="p">{</span>
  <span class="p">...</span><span class="nx">mapActions</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">getProducts</span><span class="dl">'</span>
  <span class="p">])</span>
<span class="p">},</span>
<span class="nx">created</span> <span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Delegación de funcionalidad al store</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">getProducts</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">...</span>
</code></pre></div></div> <p><strong>frontend/src/store/index.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">actions</span><span class="p">:</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">getProducts</span> <span class="p">(</span><span class="nx">actionContext</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">commit</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actionContext</span>
    <span class="kd">const</span> <span class="nx">productsURL</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/api/products</span><span class="dl">'</span>

    <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// Caso 1: Al invocar a la acción getProducts al inicio de la vista se crea la lista de productos si el servidor responde exitosamente</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Caso 2: Al invocar a la acción getProducts al inicio de la vista NO se crea la lista de productos si el servidor responde con error</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">...</span>
</code></pre></div></div> <h4 id="implementación-de-pruebas-sobre-la-vista-login"> <a href="#implementación-de-pruebas-sobre-la-vista-login" class="anchor-heading" aria-labelledby="implementación-de-pruebas-sobre-la-vista-login"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implementación de pruebas sobre la vista Login </h4> <p>Vamos a escribir las pruebas para los casos que describimos anteriormente.</p> <h5 id="caso-1-para-un-formulario-válido-ir-a-la-página-de-productos-si-la-autenticación-fue-exitosa"> <a href="#caso-1-para-un-formulario-válido-ir-a-la-página-de-productos-si-la-autenticación-fue-exitosa" class="anchor-heading" aria-labelledby="caso-1-para-un-formulario-válido-ir-a-la-página-de-productos-si-la-autenticación-fue-exitosa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Caso 1: Para un formulario válido ir a la página de productos si la autenticación fue exitosa </h5> <p>Resultado esperado</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Al resolverse la promesa del método Auth.signInWithEmailAndPassword llama al método $router.push 
</code></pre></div></div> <p>La implementación de estas pruebas las escribiremos en un nuevo archivo llamado <code class="language-plaintext highlighter-rouge">Login.spec.js</code> en la carpeta <code class="language-plaintext highlighter-rouge">frontend/tests/unit</code> con el siguiente contenido:</p> <p><strong>frontend/tests/unit/Login.spec.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">mount</span><span class="p">,</span> <span class="nx">createLocalVue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@vue/test-utils</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuetify</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuetify</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">flushPromises</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">flush-promises</span><span class="dl">'</span>

<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/App.vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/router</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Auth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span>

<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span><span class="p">,()</span><span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">Auth</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">signInWithEmailAndPassword</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}))</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Login.vue</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">localVue</span>
  <span class="kd">let</span> <span class="nx">vuetify</span>

  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">localVue</span> <span class="o">=</span> <span class="nx">createLocalVue</span><span class="p">()</span>
    <span class="nx">vuetify</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">()</span>

    <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">()</span>
    <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Successful login redirects to products page</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">.</span><span class="nx">mockResolvedValue</span><span class="p">()</span>
    <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,{</span>
      <span class="nx">localVue</span><span class="p">,</span>
      <span class="nx">vuetify</span><span class="p">,</span>
      <span class="nx">store</span><span class="p">,</span>
      <span class="nx">router</span>
    <span class="p">})</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">vm</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=username]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">testlogin@boolean.cl</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=password]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">somepass</span><span class="dl">'</span><span class="p">)</span>

    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=login-btn]</span><span class="dl">'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">)</span>
    <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">vm</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">).</span><span class="nx">toHaveBeenCalledWith</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
  <span class="p">})</span>
<span class="p">})</span>

</code></pre></div></div> <p>Elimina el <code class="language-plaintext highlighter-rouge">example.spec.js</code> que se creo junto con la aplicación. No lo usaremos.</p> <p>Vemos que incluimos un bloque <code class="language-plaintext highlighter-rouge">beforeEach</code> que nos permitirá hacer algunas acciones comunes relativas a las pruebas que escribiremos como por ejemplo dobles de prueba para la autenticación y su correspondiente <code class="language-plaintext highlighter-rouge">mockReset</code> para así asegurarnos de cumplir el <a href="http://agileinaflash.blogspot.com/2009/02/first.html">principio FIRST</a> manteniendo a cada una de las pruebas “aisladas” entre si. Aprovechando que nuestras vistas están integradas con el enrutador de la aplicación, realizamos una navegación hacia la ruta <code class="language-plaintext highlighter-rouge">/</code> para asegurarnos que cuando la aplicación sea montada para las pruebas, se utilice la vista correcta.</p> <p>Ahora al mirar la prueba vemos como podemos configurar que la promesa asociada que retorna el método <code class="language-plaintext highlighter-rouge">Auth.signInWithEmailAndPassword</code> se resuelva con ayuda de jest en la función <code class="language-plaintext highlighter-rouge">mockResolvedValue</code>, al ser llamada en el contexto de la aplicación Vue esta no se resolverá automáticamente. Para poder lograr esto utilizaremos la librería <code class="language-plaintext highlighter-rouge">flush-promises</code>. Podemos ver una explicación desde la propia documentación de Vue relacionada a esto en <a href="https://vue-test-utils.vuejs.org/guides/testing-async-components.html#asynchronous-behavior-outside-of-vue">este enlace</a></p> <p>Vamos a instalar esta librería ejecutando lo siguiente en nuestra terminal preocupándonos de navagar hasta el directorio <code class="language-plaintext highlighter-rouge">frontend</code> en nuestro proyecto:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">--save-dev</span> flush-promises
</code></pre></div></div> <p>Ahora ya estamos en condiciones de correr las pruebas que escribimos para la vista <code class="language-plaintext highlighter-rouge">Login.vue</code>. Al correr el comando <code class="language-plaintext highlighter-rouge">npm run test:unit</code> veremos lo siguiente:</p> <p><img src="images/07-testing-frontend-01.png" alt="Imagen que muestra la ejecución de Jest" /></p> <p>Como vemos remarcado en la imagen aún no hemos abordado todos los casos para esta vista. Si vamos a la carpeta coverage que se debe haber creado en la raíz del directorio <code class="language-plaintext highlighter-rouge">frontend</code> y analizamos el archivo <code class="language-plaintext highlighter-rouge">frontend/src/Login.vue</code> veremos lo siguiente:</p> <p><img src="images/07-testing-frontend-02.png" alt="Imagen que muestra métrica branch no cubierta" /></p> <p>Esto quiere decir que necesitamos una prueba que cubra el caso en el cual se llama a la función <code class="language-plaintext highlighter-rouge">login</code> pero el formulario no es válido.</p> <p>En adelante vamos a complementar este archivo agregando los bloques <code class="language-plaintext highlighter-rouge">it</code> dentro del bloque <code class="language-plaintext highlighter-rouge">describe</code> en el mismo orden que hicimos nuestro análisis</p> <h5 id="caso-2-para-un-formulario-inválido-no-llamamos-al-método-de-autenticación"> <a href="#caso-2-para-un-formulario-inválido-no-llamamos-al-método-de-autenticación" class="anchor-heading" aria-labelledby="caso-2-para-un-formulario-inválido-no-llamamos-al-método-de-autenticación"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Caso 2: Para un formulario inválido NO llamamos al método de autenticación </h5> <p>Resultado esperado</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NO se llama al Auth.signInWithEmailAndPassword
</code></pre></div></div> <p>la implementación de la prueba sería la siguiente:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Does not call Auth.signInWithEmailAndPassword if form is not valid</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">vuetify</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">(),</span>
    <span class="nx">store</span><span class="p">,</span>
    <span class="nx">router</span>
  <span class="p">})</span>
  <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=login-btn]</span><span class="dl">'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">)</span>
  
  <span class="nx">expect</span><span class="p">(</span><span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">).</span><span class="nx">not</span><span class="p">.</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
<span class="p">})</span>
</code></pre></div></div> <p>Ahora al volver a ejecutar las pruebas vemos como ya hemos abarcado el 100% de los casos para esta vista en la siguiente imagen:</p> <p><img src="images/07-testing-frontend-03.png" alt="Imagen que muestra cobertura total en el archivo Login.vue" /></p> <p>Podemos notar que con estas 2 pruebas ya hemos abarcado casi la mitad de lo que hemos construido hasta el momento. Nuestro enfoque será primero escribir pruebas de “alto nivel” que nos permitan abarcar la mayor cantidad de código posible de forma de tener una base de confianza que corrobore que al refactorizar escribiendo código mejor estructurado, la funcionalidad general de la aplicación se mantenga sin cambios.</p> <p>El archivo <code class="language-plaintext highlighter-rouge">frontend/tests/unit/Login.spec.js</code> debería haber quedado de la siguiente forma:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">mount</span><span class="p">,</span> <span class="nx">createLocalVue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@vue/test-utils</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuetify</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuetify</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">flushPromises</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">flush-promises</span><span class="dl">'</span>

<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/App.vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/router</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Auth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span>

<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span><span class="p">,()</span><span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">Auth</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">signInWithEmailAndPassword</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}))</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Login.vue</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">localVue</span>
  <span class="kd">let</span> <span class="nx">vuetify</span>

  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">localVue</span> <span class="o">=</span> <span class="nx">createLocalVue</span><span class="p">()</span>
    <span class="nx">vuetify</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">()</span>

    <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">()</span>
  <span class="p">})</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Successful login redirects to products page</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">.</span><span class="nx">mockResolvedValue</span><span class="p">()</span>
    <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,{</span>
      <span class="nx">localVue</span><span class="p">,</span>
      <span class="na">vuetify</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">(),</span>
      <span class="nx">store</span><span class="p">,</span>
      <span class="nx">router</span>
    <span class="p">})</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">vm</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=username]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">testlogin@boolean.cl</span><span class="dl">'</span><span class="p">)</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=password]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">somepass</span><span class="dl">'</span><span class="p">)</span>

    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=login-btn]</span><span class="dl">'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">)</span>
    <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">vm</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">).</span><span class="nx">toHaveBeenCalledWith</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
  <span class="p">})</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Does not call Auth.signInWithEmailAndPassword if form is not valid</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">vuetify</span><span class="p">:</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">(),</span>
      <span class="nx">store</span><span class="p">,</span>
      <span class="nx">router</span>
    <span class="p">})</span>
    <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=login-btn]</span><span class="dl">'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">)</span>
    
    <span class="nx">expect</span><span class="p">(</span><span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">).</span><span class="nx">not</span><span class="p">.</span><span class="nx">toHaveBeenCalled</span><span class="p">()</span>
  <span class="p">})</span>
<span class="p">})</span>

</code></pre></div></div> <h4 id="implementación-de-pruebas-sobre-la-vista-products"> <a href="#implementación-de-pruebas-sobre-la-vista-products" class="anchor-heading" aria-labelledby="implementación-de-pruebas-sobre-la-vista-products"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implementación de pruebas sobre la vista Products </h4> <p>Pasaremos a hacer las pruebas para productos.</p> <h5 id="caso-1-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-se-crea-la-lista-de-productos-si-el-servidor-responde-exitosamente"> <a href="#caso-1-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-se-crea-la-lista-de-productos-si-el-servidor-responde-exitosamente" class="anchor-heading" aria-labelledby="caso-1-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-se-crea-la-lista-de-productos-si-el-servidor-responde-exitosamente"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Caso 1: Al invocar a la acción getProducts al inicio de la vista se crea la lista de productos si el servidor responde exitosamente </h5> <p>Resultado esperado</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Al resolverse la promesa de axios, la vista agrega los elementos en función de la cantidad de productos que provienen del servidor
</code></pre></div></div> <p>La implementación de estas pruebas las escribieremos en un nuevo archivo llamado <code class="language-plaintext highlighter-rouge">Products.spec.js</code> en la carpeta <code class="language-plaintext highlighter-rouge">frontend/tests/unit</code> con el siguiente contenido:</p> <p><strong>frontend/tests/unit/Products.spec.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">mount</span><span class="p">,</span> <span class="nx">createLocalVue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@vue/test-utils</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">flushPromises</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">flush-promises</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuetify</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuetify</span><span class="dl">'</span>

<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/App.vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/store</span><span class="dl">'</span>                  
<span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/router</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">products</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../../fixtures/products.json</span><span class="dl">'</span>

<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">,()</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">get</span><span class="p">:</span> <span class="nx">jest</span><span class="p">.</span><span class="nx">fn</span><span class="p">()</span>
<span class="p">}))</span>

<span class="nx">jest</span><span class="p">.</span><span class="nx">mock</span><span class="p">(</span><span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span><span class="p">,()</span> <span class="o">=&gt;</span> <span class="p">({</span>
  <span class="na">Auth</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">currentUser</span><span class="p">:</span> <span class="p">{</span> 
      <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">dummyUser</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">getIdToken</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="dl">'</span><span class="s1">fakeToken</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}))</span>

<span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">Product.vue</span><span class="dl">'</span><span class="p">,()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">localVue</span>
  <span class="kd">let</span> <span class="nx">vuetify</span>

  <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">localVue</span> <span class="o">=</span> <span class="nx">createLocalVue</span><span class="p">()</span>
    <span class="nx">vuetify</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">()</span>

    <span class="nx">store</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({</span>
      <span class="na">products</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">})</span>
    <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">()</span>
    <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Shows a list of products when the server response successfully</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,{</span>
      <span class="nx">localVue</span><span class="p">,</span>
      <span class="nx">vuetify</span><span class="p">,</span>
      <span class="nx">store</span><span class="p">,</span>
      <span class="nx">router</span>
    <span class="p">})</span>
    <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">.</span><span class="nx">mockResolvedValue</span><span class="p">({</span> <span class="na">data</span><span class="p">:</span> <span class="nx">products</span> <span class="p">})</span>
    
    <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">}</span> <span class="p">)</span>
    <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

    <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=product-item]</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="nx">products</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">products</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">products</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>

</code></pre></div></div> <p>Nos damos cuenta que las pruebas al igual que en el caso anterior requieren configuración como dobles de prueba (1 Mock y 1 Stub) y podemos notar como ahora en el bloque <code class="language-plaintext highlighter-rouge">beforeEach</code> incluimos <code class="language-plaintext highlighter-rouge">store.replaceState</code>. Esto lo deberemos hacer en cada prueba que tenga computada atributos del Store de Vuex para asegurarnos que el estado se reinicia en cada prueba y así estas se mantienen aisladas entre sí como recordamos en las pruebas de la vista anterior.</p> <p>Si miramos la prueba notamos que en este caso como la llamada a la acción de Vuex que desencadena que se configure el valor del estado <code class="language-plaintext highlighter-rouge">products</code> se hace en el método del ciclo de vida <code class="language-plaintext highlighter-rouge">created</code> del componente, por esto forzamos a que esto ocurra navegando hacia la ruta de la página de productos a través del router utilizando <code class="language-plaintext highlighter-rouge">router.push</code></p> <p>Al correr las pruebas veremos lo que muestra la siguiente imagen:</p> <p><img src="images/07-testing-frontend-04.png" alt="Imagen que muestra falta de cobertura en store" /></p> <p>Hemos marcado también el store porque sabemos nuestra vista interactúa con esta sección del código. Si analizamos el archivo de cobertura asociado a este veremos lo siguiente:</p> <p><img src="images/07-testing-frontend-05.png" alt="Imagen que muestra falta de cobertura en store" /></p> <p>Resolveremos esto en el siguiente caso</p> <h5 id="caso-2-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-no-se-crea-la-lista-de-productos-si-el-servidor-responde-con-error"> <a href="#caso-2-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-no-se-crea-la-lista-de-productos-si-el-servidor-responde-con-error" class="anchor-heading" aria-labelledby="caso-2-al-invocar-a-la-acción-getproducts-al-inicio-de-la-vista-no-se-crea-la-lista-de-productos-si-el-servidor-responde-con-error"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Caso 2: Al invocar a la acción getProducts al inicio de la vista NO se crea la lista de productos si el servidor responde con error </h5> <p>Resultado esperado</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>No se muestran productos en la lista cuando la llamada al servidor responde con error
</code></pre></div></div> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Shows an empty list of products when the server response failed</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,{</span>
    <span class="nx">localVue</span><span class="p">,</span>
    <span class="nx">vuetify</span><span class="p">,</span>
    <span class="nx">store</span><span class="p">,</span>
    <span class="nx">router</span>
  <span class="p">})</span>
  <span class="kd">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Database Error in Server</span><span class="dl">'</span>
  <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">.</span><span class="nx">mockRejectedValue</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">))</span>
  
  <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">}</span> <span class="p">)</span>
  <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=product-item]</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">products</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([])</span>
<span class="p">})</span>
</code></pre></div></div> <p>Ejecutamos las pruebas y veremos como hemos logrado cubrir todo el código como muestra la siguiente imagen:</p> <p><img src="images/07-testing-frontend-06.png" alt="Imagen que muestra cobertura total en store" /></p> <h4 id="refactorización-del-store"> <a href="#refactorización-del-store" class="anchor-heading" aria-labelledby="refactorización-del-store"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Refactorización del Store </h4> <p>Con esto ya tenemos una capa de cobertura o caracterización completa del código que nos permite implementar la refactorización con mayor confianza. En el caso del framework Vue con Vuex es clásico que el <code class="language-plaintext highlighter-rouge">store</code> es la primera fuente de <em>code smells</em> y tenemos una oportunidad de extraer la llamada al servidor en un servicio independiente. Para esto creamos el directorio <code class="language-plaintext highlighter-rouge">services</code> dentro de <code class="language-plaintext highlighter-rouge">src</code> y ahora crearemos un archivo llamado <code class="language-plaintext highlighter-rouge">product.service.js</code> con el siguiente contenido:</p> <p><strong>frontend/src/services/product.service.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Auth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">productsURL</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">api/products</span><span class="dl">'</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">getProducts</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">currentUser</span><span class="p">?.</span><span class="nx">getIdToken</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
      <span class="kd">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">Authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">token</span><span class="p">}</span><span class="s2">`</span>
      <span class="p">}</span>
      <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">productsURL</span><span class="p">,</span> <span class="p">{</span> <span class="nx">headers</span> <span class="p">})</span>
      <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Productos momentáneamente no disponibles</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div> <p>Y en el <code class="language-plaintext highlighter-rouge">store</code> quedaría así:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuex</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">productService</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/services/product.service</span><span class="dl">'</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Vuex</span><span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="k">new</span> <span class="nx">Vuex</span><span class="p">.</span><span class="nx">Store</span><span class="p">({</span>
  <span class="na">state</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">products</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="na">mutations</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">SET_PRODUCTS</span> <span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">products</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">products</span> <span class="o">=</span> <span class="nx">products</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>
    <span class="k">async</span> <span class="nx">getProducts</span> <span class="p">(</span><span class="nx">actionContext</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">commit</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actionContext</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">productService</span><span class="p">.</span><span class="nx">getProducts</span><span class="p">()</span>
        <span class="nx">commit</span><span class="p">(</span><span class="dl">'</span><span class="s1">SET_PRODUCTS</span><span class="dl">'</span><span class="p">,</span> <span class="nx">products</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>

</code></pre></div></div> <p>Ahora volvemos a ejecutar las pruebas y veremos que siguen pasando y que aún mantenemos la cobertura como muestra la siguien imagen:</p> <p><img src="images/07-testing-frontend-07.png" alt="Imagen que muestra cobertura total en store" /></p> <h4 id="nueva-funcionalidad-a-través-de-la-metodología-tdd"> <a href="#nueva-funcionalidad-a-través-de-la-metodología-tdd" class="anchor-heading" aria-labelledby="nueva-funcionalidad-a-través-de-la-metodología-tdd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nueva funcionalidad a través de la metodología TDD </h4> <p>Escribiremos una nueva funcionalidad para nuestra aplicación. Antes de comenzar haremos una simulación de como se generaría la necesidad de programar algo nuevo en una aplicación si estuvieramos en el caso de una aplicación en la que hay un equipo multidisciplinario involucrado comenzando desde quienes solicitan el cambio hasta como lo hace el programador para describir lo que tiene que hacer y aprovecharemos esto para aplicar la metodolodía TDD: Desarrollo guiado por pruebas</p> <p><strong>Descripción de la solución de alto nivel</strong></p> <blockquote> <p>Crear una alerta centralizada para toda la aplicación que debe mostrar información tanto de éxito como de error manteniendo el estilo visual actual</p> </blockquote> <p>El texto anterior surge de una coordinación entre personas del área de UI, UX, Desarrolladores y roles de negocio en una empresa y que termina en manos de los programadores que debemos ser capaces de implementar estos requerimientos a partir de nuestro conocimientos en la tecnología que está escrita nuestra aplicación.</p> <p>Cuando nos enfrentamos al desafío de implementar esta funcionalidad gracias a nuestro conocimiento en programación, conocimiento del Framework Vue y entendiendo como funciona el patrón de manejo de estados de Vuex, podríamos refinar más el requerimiento ahora en términos técnicos</p> <p><strong>Descripción técnica</strong></p> <blockquote> <p>Lo que haremos será escribir un componente que nos permita mostrar una alerta central que se activará a partir de una propiedad que configuraremos en el store. Para mostrar la alerta de forma central la agregaremos al componente App.vue que se conectará al estado y mostrará o no la alerta en función de si está la alerta o no asignada. El valor del estado lo llamaremos <code class="language-plaintext highlighter-rouge">alert</code> y su valor por defecto será <code class="language-plaintext highlighter-rouge">null</code>. Para poder asignar una alerta en el estado expondremos una acción llamada setAlert para estos fines. En cuanto a la UI utilizaremos el componente <code class="language-plaintext highlighter-rouge">&lt;v-alert&gt;</code> que trae Vuetify y modelaremos la alerta como un objeto que tenga las propiedades <code class="language-plaintext highlighter-rouge">message</code> y <code class="language-plaintext highlighter-rouge">type</code>.</p> </blockquote> <p>Si bien podemos tener una estrategia en mente y entender los conceptos de arquitectura del framework, tener ideas por sobre como resolverlo y probar todo esto directamente en la aplicación, lo que haremos será modificar nuestras pruebas para hacerlas fallar debido a que consultaremos sobre cosas que aún no están programadas y relacionadas a esta funcionalidad.</p> <h5 id="modo-tdd"> <a href="#modo-tdd" class="anchor-heading" aria-labelledby="modo-tdd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Modo TDD </h5> <p>Lo primero será agregar un nuevo script al archivo <code class="language-plaintext highlighter-rouge">frontend/package.json</code> en la sección correspondiente de la siguiente forma</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">"</span><span class="s2">tdd</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">npm run test:unit -- --watchAll</span><span class="dl">"</span>
</code></pre></div></div> <p>Ahora ejecutamos el comando <code class="language-plaintext highlighter-rouge">npm run tdd</code> y veremos algo como en la siguiente imagen:</p> <p><img src="images/07-testing-frontend-08.png" alt="Imagen que muestra modo tdd de jest" /></p> <p>Vemos que ahora la terminal está esperando que se hagan cambios ya sea en las pruebas o en el código fuente.</p> <h4 id="implementación-de-la-alerta-cuando-falla-autenticación-en-vista-login"> <a href="#implementación-de-la-alerta-cuando-falla-autenticación-en-vista-login" class="anchor-heading" aria-labelledby="implementación-de-la-alerta-cuando-falla-autenticación-en-vista-login"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implementación de la alerta cuando falla autenticación en vista Login </h4> <p>Comenzaremos por modificar las pruebas que ya habíamos escrito y así hacerlas fallar. Agregaremos una nueva prueba para la vista Login</p> <p><strong>frontend/tests/unit/Login.spec.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Login failed shows global alert</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">localVue</span><span class="p">,</span>
    <span class="nx">vuetify</span><span class="p">,</span>
    <span class="nx">store</span><span class="p">,</span>
    <span class="nx">router</span>
  <span class="p">})</span>
  <span class="kd">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Invalid user</span><span class="dl">'</span>
  <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">.</span><span class="nx">mockRejectedValue</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">))</span>
  <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=username]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">sebastian@boolean.cl</span><span class="dl">'</span><span class="p">)</span>
  <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=password]</span><span class="dl">'</span><span class="p">).</span><span class="nx">setValue</span><span class="p">(</span><span class="dl">'</span><span class="s1">academiaboolean</span><span class="dl">'</span><span class="p">)</span>
  
  <span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=login-btn]</span><span class="dl">'</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

  <span class="kd">const</span> <span class="nx">expectedMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Error al hacer autenticación</span><span class="dl">'</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[role=alert]</span><span class="dl">'</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">expectedMessage</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">alert</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">({</span>
    <span class="na">message</span><span class="p">:</span> <span class="nx">expectedMessage</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div> <p>Al actualizarse las pruebas veremos un error como muestra la siguiente imagen:</p> <p><img src="images/07-testing-frontend-09.png" alt="Imagen que muestra error en la terminal" /></p> <p>Esto ocurre porque en la vista Login no capturamos las excepciones cuando ocurre un error en la función <code class="language-plaintext highlighter-rouge">Auth.signInWithEmailAndPassword</code>. Vamos a modificar esta vista en el archivo <code class="language-plaintext highlighter-rouge">frontend/src/views/Login.vue</code> reemplazando la función <code class="language-plaintext highlighter-rouge">login</code> por lo siguiente:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">login</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">await</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Ahora al recargarse las pruebas veremos que el error ha cambiado a lo que muestra la siguiente imagen:</p> <p><img src="images/07-testing-frontend-10.png" alt="Imagen que muestra error en prueba" /></p> <p>Como vimos en unos de los capítulos anteriores, lo que deberíamos hacer es escribir el código más simple posible que que sea capaz se hacer pasar la prueba y luego refactorizar. En este caso como la prueba está fallando agregaremos en la sección <code class="language-plaintext highlighter-rouge">template</code> el código más simple posible que logre resolver esta prueba:</p> <p><strong>frontend/src/views/Login.vue</strong></p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;v-main</span> <span class="na">class=</span><span class="s">"home"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">role=</span><span class="s">"alert"</span><span class="nt">&gt;</span>
      Error al hacer autenticación
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;v-card</span> <span class="na">width=</span><span class="s">"400px"</span> <span class="na">class=</span><span class="s">"mx-auto my-auto"</span><span class="nt">&gt;</span>
    ...
    <span class="nt">&lt;/v-card&gt;</span>
  <span class="nt">&lt;/v-main&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div> <p>Ahora al recargarse las pruebas vemos que el error ha cambiado:</p> <p><img src="images/07-testing-frontend-11.png" alt="Imagen que muestra error en prueba" /></p> <p>Y tal como lo hicimos en el caso anterior escribiremos el código más simple posible para pasar esta prueba. esto sería modificar el store en la propiedad <code class="language-plaintext highlighter-rouge">state</code> con el siguiente código:</p> <p><strong>frontend/src/store/index.js</strong></p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>

<span class="k">export</span> <span class="k">default</span> <span class="k">new</span> <span class="nx">Vuex</span><span class="p">.</span><span class="nx">Store</span><span class="p">({</span>
  <span class="na">state</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">products</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">alert</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Error al hacer autenticación</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">...</span>

<span class="p">})</span>

</code></pre></div></div> <p>Con este último cambio al recargarse las pruebas vemos que están pasando todas.</p> <h5 id="refactorización"> <a href="#refactorización" class="anchor-heading" aria-labelledby="refactorización"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Refactorización </h5> <p>Ahora haremos algunos cambios para que nuestro código sea diseñado como habíamos descrito en la definición técnica.</p> <p>Primero vamos a reemplazar completamente la sección <code class="language-plaintext highlighter-rouge">script</code> para que quede de la siguiente manera:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mapActions</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Auth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/firebase</span><span class="dl">'</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">emailRules</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!!</span><span class="nx">v</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">El correo es requerido</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="sr">/.+@.+</span><span class="se">\.</span><span class="sr">.+/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">El correo debe tener formato válido</span><span class="dl">'</span>
      <span class="p">],</span>
      <span class="na">password</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">passwordRules</span><span class="p">:</span> <span class="p">[(</span><span class="nx">v</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">!!</span><span class="nx">v</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">La contraseña es requerida</span><span class="dl">'</span><span class="p">],</span>
      <span class="na">showPassword</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">mapActions</span><span class="p">([</span><span class="dl">'</span><span class="s1">setAlert</span><span class="dl">'</span><span class="p">]),</span>
    <span class="nx">validate</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">login</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="k">await</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">signInWithEmailAndPassword</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setAlert</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Error al hacer autenticación</span><span class="dl">'</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span> <span class="p">})</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>

</code></pre></div></div> <p>Si bien las pruebas siguen pasando podemos ver un mensaje de error que dice lo siguiente</p> <blockquote> <p>console.error node_modules/vuex/dist/vuex.common.js:499 [vuex] unknown action type: setAlert</p> </blockquote> <p>Esto nos está diciendo que estamos tratando de mapear una acción que no existe. Para esto iremos al archivo <code class="language-plaintext highlighter-rouge">frontend/src/store/index.js</code> y lo reemplazaremos completamente con lo siguiente:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vue</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">Vuex</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">productService</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/services/product.service</span><span class="dl">'</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Vuex</span><span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="k">new</span> <span class="nx">Vuex</span><span class="p">.</span><span class="nx">Store</span><span class="p">({</span>
  <span class="na">state</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">products</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">alert</span><span class="p">:</span> <span class="kc">null</span>
  <span class="p">},</span>
  <span class="na">mutations</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">SET_PRODUCTS</span> <span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">products</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">products</span> <span class="o">=</span> <span class="nx">products</span>
    <span class="p">},</span>
    <span class="nx">SET_ALERT</span> <span class="p">(</span><span class="nx">store</span><span class="p">,</span> <span class="nx">alert</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">store</span><span class="p">.</span><span class="nx">alert</span> <span class="o">=</span> <span class="nx">alert</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">actions</span><span class="p">:</span> <span class="p">{</span>
    <span class="k">async</span> <span class="nx">getProducts</span> <span class="p">(</span><span class="nx">actionContext</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">commit</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actionContext</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">productService</span><span class="p">.</span><span class="nx">getProducts</span><span class="p">()</span>
        <span class="nx">commit</span><span class="p">(</span><span class="dl">'</span><span class="s1">SET_PRODUCTS</span><span class="dl">'</span><span class="p">,</span> <span class="nx">products</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">setAlert</span> <span class="p">(</span><span class="nx">actionContext</span><span class="p">,</span> <span class="nx">alert</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">commit</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actionContext</span>
      <span class="nx">commit</span><span class="p">(</span><span class="dl">'</span><span class="s1">SET_ALERT</span><span class="dl">'</span><span class="p">,</span> <span class="nx">alert</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>

</code></pre></div></div> <p>Vemos que al recargarse las pruebas estas siguen pasando. Ahora modificaremos el archivo <code class="language-plaintext highlighter-rouge">src/App.vue</code> para agregar la alerta global. Y lo reemplazamos por lo siguiente:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;v-app&gt;</span>
    <span class="nt">&lt;v-main&gt;</span>
      <span class="nt">&lt;v-alert</span>
        <span class="na">v-if=</span><span class="s">"alert"</span>
        <span class="na">class=</span><span class="s">"text-center"</span>
        <span class="na">:type=</span><span class="s">"alert.type"</span>
        <span class="na">dismissible</span>
        <span class="na">outlined</span>
        <span class="na">border=</span><span class="s">"left"</span>
        <span class="err">@</span><span class="na">input=</span><span class="s">"closeAlert"</span>
      <span class="nt">&gt;</span>
        
      <span class="nt">&lt;/v-alert&gt;</span>
      <span class="nt">&lt;router-view&gt;&lt;/router-view&gt;</span>
    <span class="nt">&lt;/v-main&gt;</span>
  <span class="nt">&lt;/v-app&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mapActions</span><span class="p">,</span> <span class="nx">mapState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">App</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">computed</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">mapState</span><span class="p">([</span> <span class="dl">'</span><span class="s1">alert</span><span class="dl">'</span> <span class="p">])</span>
  <span class="p">},</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">mapActions</span><span class="p">([</span><span class="dl">'</span><span class="s1">setAlert</span><span class="dl">'</span><span class="p">]),</span>
    <span class="nx">closeAlert</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setAlert</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>

</code></pre></div></div> <p>Una buena oportunidad de separación de responsabilidades sería extraer la alerta a su propio componente y mediante <code class="language-plaintext highlighter-rouge">props</code> pasar las propiedades reactivas desde el componente <code class="language-plaintext highlighter-rouge">App.vue</code> al <code class="language-plaintext highlighter-rouge">AppAlert.vue</code> que crearemos ahora. Para eso creamos el componente <code class="language-plaintext highlighter-rouge">src/components/AppAlert.vue</code> con el siguiente contenido:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">v</span><span class="o">-</span><span class="nx">alert</span>
    <span class="kd">class</span><span class="o">=</span><span class="dl">"</span><span class="s2">text-center</span><span class="dl">"</span>
    <span class="p">:</span><span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">type</span><span class="dl">"</span>
    <span class="nx">dismissible</span>
    <span class="nx">outlined</span>
    <span class="nx">border</span><span class="o">=</span><span class="dl">"</span><span class="s2">left</span><span class="dl">"</span>
    <span class="p">@</span><span class="nd">input</span><span class="o">=</span><span class="dl">"</span><span class="s2">closeAlert</span><span class="dl">"</span>
  <span class="o">&gt;</span>
  
  <span class="o">&lt;</span><span class="sr">/v-alert</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">props</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">message</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
      <span class="na">default</span><span class="p">:</span> <span class="dl">''</span>
    <span class="p">},</span>
    <span class="na">type</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
      <span class="na">default</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span>
    <span class="p">},</span>
    <span class="na">closeAlert</span><span class="p">:</span> <span class="nb">Function</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span>
</code></pre></div></div> <p>Ahora con los cambios necesarios en el <code class="language-plaintext highlighter-rouge">App.vue</code>, quedaría de la siguiente forma:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">v</span><span class="o">-</span><span class="nx">app</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">v</span><span class="o">-</span><span class="nx">main</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">app</span><span class="o">-</span><span class="nx">alert</span> 
        <span class="nx">v</span><span class="o">-</span><span class="k">if</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert</span><span class="dl">"</span>
        <span class="p">:</span><span class="nx">message</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert.message</span><span class="dl">"</span>
        <span class="p">:</span><span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">alert.type</span><span class="dl">"</span>
        <span class="p">:</span><span class="nx">closeAlert</span><span class="o">=</span><span class="dl">"</span><span class="s2">closeAlert</span><span class="dl">"</span>
      <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nx">router</span><span class="o">-</span><span class="nx">view</span><span class="o">&gt;&lt;</span><span class="sr">/router-view</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/v-main</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/v-app</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">mapActions</span><span class="p">,</span> <span class="nx">mapState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vuex</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">AppAlert</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@/components/AppAlert</span><span class="dl">'</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">App</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">AppAlert</span>
  <span class="p">},</span>
  <span class="na">computed</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">mapState</span><span class="p">([</span> <span class="dl">'</span><span class="s1">alert</span><span class="dl">'</span> <span class="p">])</span>
  <span class="p">},</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">mapActions</span><span class="p">([</span><span class="dl">'</span><span class="s1">setAlert</span><span class="dl">'</span><span class="p">]),</span>
    <span class="nx">closeAlert</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setAlert</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script</span><span class="err">&gt;
</span></code></pre></div></div> <p>Ahora quitaremos el código HTML que agregamos a la vista Login en la sección <code class="language-plaintext highlighter-rouge">template</code> y veremos que nuestras pruebas continúan pasando a pesar de toda la refactorización que hemos hecho.</p> <h4 id="implementación-de-la-alerta-cuando-falla-el-servidor-en-vista-products"> <a href="#implementación-de-la-alerta-cuando-falla-el-servidor-en-vista-products" class="anchor-heading" aria-labelledby="implementación-de-la-alerta-cuando-falla-el-servidor-en-vista-products"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implementación de la alerta cuando falla el servidor en vista Products </h4> <p>Ahora modificaremos la prueba que escribimos para el caso que el servidor falla agregando dos nuevas sentencias <code class="language-plaintext highlighter-rouge">expect</code> a la prueba ya escrita. Reemplazamos por el siguiente código</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Shows an empty list of products when the server response failed</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">mount</span><span class="p">(</span><span class="nx">App</span><span class="p">,{</span>
    <span class="nx">localVue</span><span class="p">,</span>
    <span class="nx">vuetify</span><span class="p">,</span>
    <span class="nx">store</span><span class="p">,</span>
    <span class="nx">router</span>
  <span class="p">})</span>
  <span class="kd">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Database Error in Server</span><span class="dl">'</span>
  <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">.</span><span class="nx">mockRejectedValue</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">))</span>
  
  <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Products</span><span class="dl">'</span> <span class="p">})</span>
  <span class="k">await</span> <span class="nx">flushPromises</span><span class="p">()</span>

  <span class="kd">const</span> <span class="nx">expectedMessage</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Productos momentáneamente no disponibles</span><span class="dl">'</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">findAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-cy=product-item]</span><span class="dl">'</span><span class="p">)).</span><span class="nx">toHaveLength</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">store</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">products</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">([])</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">'</span><span class="s1">[role=alert]</span><span class="dl">'</span><span class="p">).</span><span class="nx">text</span><span class="p">()).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">expectedMessage</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div> <p><img src="images/07-testing-frontend-12.png" alt="Imagen que muestra error en prueba" /></p> <p>Esta vez el código más simple posible para resolver esta prueba no es agregar el HTML de forma estática, porque ya hemos construido nuestra alerta global. Lo único que nos falta es agregar esta alerta cuando detectamos que el servidor al momento de obtener los productos falle. Modificaremos el archivo <code class="language-plaintext highlighter-rouge">frontend/src/store/index.js</code> en la función <code class="language-plaintext highlighter-rouge">getProducts</code> para que quede como muestra el siguiente código:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="p">...</span>
<span class="k">async</span> <span class="nx">getProducts</span> <span class="p">(</span><span class="nx">actionContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">commit</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">actionContext</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">productService</span><span class="p">.</span><span class="nx">getProducts</span><span class="p">()</span>
    <span class="nx">commit</span><span class="p">(</span><span class="dl">'</span><span class="s1">SET_PRODUCTS</span><span class="dl">'</span><span class="p">,</span> <span class="nx">products</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">commit</span><span class="p">(</span><span class="dl">'</span><span class="s1">SET_ALERT</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span> <span class="p">})</span>
  <span class="p">}</span>
<span class="p">},</span>
<span class="p">...</span>

</code></pre></div></div> <p>Vemos que la prueba sigue fallando. Esto es porque para mantener cada una de las pruebas aisladas antes de cada prueba estamos creando un estado inicial para el store y actualmente no incluye el valor <code class="language-plaintext highlighter-rouge">alert</code>. Iremos a modificar el bloque <code class="language-plaintext highlighter-rouge">beforeEach</code> y lo reemplazaremos por lo siguiente:</p> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="p">...</span>
<span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">localVue</span> <span class="o">=</span> <span class="nx">createLocalVue</span><span class="p">()</span>
  <span class="nx">vuetify</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vuetify</span><span class="p">()</span>

  <span class="nx">store</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({</span>
    <span class="na">products</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">alert</span><span class="p">:</span> <span class="kc">null</span>
  <span class="p">})</span>
  <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">.</span><span class="nx">mockReset</span><span class="p">()</span>
  <span class="nx">router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>
<span class="p">...</span>
</code></pre></div></div> <p>Luego de hacer este cambio las pruebas se recargarán y podemos ver como están pasando todas una vez más.</p> <p><img src="images/07-testing-frontend-13.png" alt="Después del refactor y tdd" /></p> <h4 id="probar-la-aplicación-con-servidor-y-frontend-corriendo"> <a href="#probar-la-aplicación-con-servidor-y-frontend-corriendo" class="anchor-heading" aria-labelledby="probar-la-aplicación-con-servidor-y-frontend-corriendo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Probar la aplicación con servidor y frontend corriendo </h4> <p>Ahora probaremos la aplicación manualmente corriendo el comando <code class="language-plaintext highlighter-rouge">npm run serve</code> y en otra ventana corriendo <code class="language-plaintext highlighter-rouge">npm run dev</code> en Frontend y Backend respectivamente. Como en la siguiente imagen:</p> <p><img src="images/07-testing-frontend-14.png" alt="corriedo dos terminales" /></p> <p>Y podemos ver cómo en la UI tenemos la alerta funcionando:</p> <p><img src="images/07-testing-frontend-15.png" alt="corriedo dos terminales" /></p> <p>Momento de un nuevo commit. Agrega lo siguiente desde la raíz del proyecto</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add <span class="nb">.</span>
git commit <span class="nt">-m</span> <span class="s2">"refactor(frontend-refactor): Se agregó set de pruebas de caracterización en el Frontend y luego un refactor para dividir responsabilidades. Además se trabajo alerta global con TDD"</span>
</code></pre></div></div> <div class="table-wrapper"><table> <tr> <th colspan="2"> <a href="./06-testing-backend.md"> <span>⬅️ </span> Refactorización utilizando pruebas de software en Backend </a> </th> <th colspan="2"> <a href="./08-development-workflow-husky.md"> Flujo de desarrollo del proyecto <span>➡️ </span> </a> </th> </tr> </table></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
